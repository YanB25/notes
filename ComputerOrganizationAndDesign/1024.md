[toc]
###课堂笔记
####cache
1. 命中率
$$H = \frac{N_1}{N_1+N_2}$$
N1访问M1的次数
N2访问M2的次数
失效律$$1-H$$
2. 平均访问时间
$$t_A = HT_{A1} + (1-H)(T_{A1}+T_M)$$
####两个层次
||cache - 主存|主存 - 辅存（合称虚存）|
|:-:|:--:|:--:|
|意义|弥补主存速度不足|扩大地址空间|
|实现|硬件实现|主要软件实现|
|一二级速度比|几比一|几百比一|
|块（页）大小|几十字节（页）|几百到几千字节|
|CPU对二级的访问|直接访问|均通过第一级|
|失效时CPU|不切换|切换到其他线程
####四个规则
1. 映像规则
当把一个块调入高一层（靠近CPU)存储器时，可以放在哪些位置上
    1. 全相连映像
    任何一块可以被放置到cache的任何位置
    利用率max，冲突率min，实现复杂度max
    1. 直接映像
    每一个块只能放置到Cache中的唯一一个位置
    利用率min，冲突率max，实现复杂度min
    1. 组相连映射
    全相连和直接的折中。组间直接相连映像，组内全相连映像
1. 查找算法
    1. 通过查找目录表来实现（块）
1. 替换算法
    1. 随机法
    2. 先进先出法
    3. 最近最少使用法（RLU）（反映程序局部性）
1. 写策略
    1. 写直达法
    写时不仅写入cache，也写入下一级存储器
    不需要“脏”位
    2. 写回法
    只写入cache。仅当cache块被替换时写回主存
    需要“脏”位
 0000
 0011
 0110
 0000 0000 0000 0000   
 